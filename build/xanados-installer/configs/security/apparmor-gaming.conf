# xanadOS AppArmor Gaming Profile Template
# Balanced security for gaming applications

# Steam profile template
/usr/lib/steam/** {
  #include <abstractions/base>
  #include <abstractions/audio>
  #include <abstractions/X>
  #include <abstractions/opengl>
  #include <abstractions/dri-enumerate>
  
  # Steam directories
  /usr/lib/steam/** rm,
  /home/*/.local/share/Steam/** rw,
  /home/*/.steam/** rw,
  
  # Game directories
  /home/*/Games/** rw,
  /opt/steam/** rw,
  
  # System access needed for games
  /usr/share/hwdata/pci.ids r,
  /sys/devices/pci**/config r,
  /proc/version r,
  /proc/cpuinfo r,
  /proc/meminfo r,
  
  # Network access for multiplayer
  network inet dgram,
  network inet stream,
  
  # Graphics and audio
  /dev/dri/** rw,
  /dev/snd/** rw,
  /dev/input/js* rw,
  /dev/input/event* rw,
  
  # Temporary files
  /tmp/** rw,
  /var/tmp/** rw,
  
  # Allow execution of game binaries
  /home/*/Games/**/* rix,
  /home/*/.local/share/Steam/steamapps/common/**/* rix,
}

# Wine/Proton profile template
/opt/wine-stable/bin/wine* {
  #include <abstractions/base>
  #include <abstractions/audio>
  #include <abstractions/X>
  #include <abstractions/opengl>
  
  # Wine directories
  /opt/wine-stable/** rm,
  /home/*/.wine/** rw,
  /home/*/Games/** rw,
  
  # Windows compatibility
  /proc/version r,
  /proc/cpuinfo r,
  /proc/meminfo r,
  /sys/devices/system/cpu/cpu*/cache/index*/size r,
  
  # Graphics
  /dev/dri/** rw,
  /usr/share/libdrm/amdgpu.ids r,
  
  # Network
  network inet dgram,
  network inet stream,
  
  # Execute permissions
  /home/*/Games/**/* rix,
  /tmp/**/* rix,
}

# General gaming application profile
profile xanados-gaming {
  #include <abstractions/base>
  #include <abstractions/audio>
  #include <abstractions/X>
  #include <abstractions/opengl>
  #include <abstractions/dri-enumerate>
  
  # Basic system access
  /proc/version r,
  /proc/cpuinfo r,
  /proc/meminfo r,
  /sys/devices/system/cpu/** r,
  
  # Graphics access
  /dev/dri/** rw,
  /sys/class/drm/** r,
  
  # Audio access
  /dev/snd/** rw,
  
  # Input devices
  /dev/input/** rw,
  
  # Network access
  network inet dgram,
  network inet stream,
  
  # User directories
  owner /home/*/** rw,
  
  # Temporary files
  /tmp/** rw,
  /var/tmp/** rw,
}
